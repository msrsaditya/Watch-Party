<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <meta
      name="description"
      content="A real-time watch party application. Watch videos in sync with friends, chat in real time, and control playback together."
    />
    <title>Watch Party</title>
    <link rel="preconnect" href="https://identitytoolkit.googleapis.com" />
    <link rel="preconnect" href="https://firestore.googleapis.com" />
    <link rel="preconnect" href="https://firebasestorage.googleapis.com" />
  </head>
  <body
    class="bg-bg text-primary h-[100dvh] w-full flex flex-col overflow-hidden"
  >
    <div
      id="toast"
      class="fixed top-[15%] left-1/2 -translate-x-1/2 bg-white/90 backdrop-blur text-black px-6 py-3 rounded-full shadow-2xl z-[20000] opacity-0 -translate-y-10 transition-all duration-300 font-semibold pointer-events-none whitespace-nowrap text-sm tracking-wide"
    ></div>

    <div
      id="auth-screen"
      class="fixed inset-0 z-[100] bg-bg flex flex-col items-center justify-center p-6 pt-safe pb-safe"
    >
      <div class="w-full max-w-sm">
        <h1
          class="text-4xl font-bold text-center mb-8 tracking-tighter text-transparent bg-clip-text bg-gradient-to-br from-white to-gray-400 drop-shadow-2xl"
        >
          Watch Party
        </h1>
        <div
          class="bg-panel rounded-2xl border border-border overflow-hidden shadow-2xl"
        >
          <div class="flex h-14 border-b border-border">
            <button
              class="flex-1 font-bold text-secondary hover:text-white transition-colors bg-panel data-[active=true]:bg-element data-[active=true]:text-white text-xs uppercase tracking-wide"
              data-auth-tab="login"
              data-active="true"
              onclick="Controller.switchAuthTab('login')"
            >
              Login
            </button>
            <button
              class="flex-1 font-bold text-secondary hover:text-white transition-colors bg-panel data-[active=true]:bg-element data-[active=true]:text-white text-xs uppercase tracking-wide"
              data-auth-tab="signup"
              onclick="Controller.switchAuthTab('signup')"
            >
              Sign Up
            </button>
          </div>
          <div id="form-login" class="p-6 space-y-4">
            <div>
              <label
                for="login-email"
                class="block text-xs font-bold text-gray-500 mb-2 ml-1 uppercase tracking-wider"
                >Email</label
              >
              <input
                type="email"
                id="login-email"
                placeholder="Enter Your Email"
                class="w-full bg-bg border border-border rounded-xl px-4 py-3 focus:border-accent-blue outline-none transition-colors text-white placeholder-muted"
              />
            </div>
            <div>
              <label
                for="login-password"
                class="block text-xs font-bold text-gray-500 mb-2 ml-1 uppercase tracking-wider"
                >Password</label
              >
              <div class="relative">
                <input
                  type="password"
                  id="login-password"
                  placeholder="Enter Your Password"
                  class="w-full bg-bg border border-border rounded-xl px-4 py-3 pr-10 focus:border-accent-blue outline-none transition-colors text-white placeholder-muted"
                />
                <button
                  type="button"
                  class="absolute right-3 top-1/2 -translate-y-1/2 text-secondary hover:text-white transition-colors"
                  onclick="Controller.togglePassword('login-password', this)"
                >
                  <i class="fas fa-eye"></i>
                </button>
              </div>
              <div class="text-right mt-2">
                <button
                  onclick="Controller.forgotPassword()"
                  class="text-xs text-accent-blue hover:text-white transition-colors"
                >
                  Forgot Password?
                </button>
              </div>
            </div>
            <button
              onclick="Controller.handleLogin()"
              class="w-full bg-white text-black font-bold py-3 rounded-xl active:scale-95 transition-all shadow-lg mt-2"
            >
              Login
            </button>
          </div>
          <div id="form-signup" class="p-6 space-y-4 hidden">
            <div>
              <label
                for="signup-name"
                class="block text-xs font-bold text-gray-500 mb-2 ml-1 uppercase tracking-wider"
                >Name</label
              >
              <input
                type="text"
                id="signup-name"
                placeholder="Enter Your Name"
                class="w-full bg-bg border border-border rounded-xl px-4 py-3 focus:border-accent-blue outline-none transition-colors text-white placeholder-muted"
              />
            </div>
            <div>
              <label
                for="signup-email"
                class="block text-xs font-bold text-gray-500 mb-2 ml-1 uppercase tracking-wider"
                >Email</label
              >
              <input
                type="email"
                id="signup-email"
                placeholder="Enter Your Email"
                class="w-full bg-bg border border-border rounded-xl px-4 py-3 focus:border-accent-blue outline-none transition-colors text-white placeholder-muted"
              />
            </div>
            <div>
              <label
                for="signup-pass"
                class="block text-xs font-bold text-gray-500 mb-2 ml-1 uppercase tracking-wider"
                >Password</label
              >
              <div class="relative">
                <input
                  type="password"
                  id="signup-pass"
                  placeholder="Create a Password"
                  class="w-full bg-bg border border-border rounded-xl px-4 py-3 pr-10 focus:border-accent-blue outline-none transition-colors text-white placeholder-muted"
                />
                <button
                  type="button"
                  class="absolute right-3 top-1/2 -translate-y-1/2 text-secondary hover:text-white transition-colors"
                  onclick="Controller.togglePassword('signup-pass', this)"
                >
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>
            <div>
              <label
                for="signup-confirm"
                class="block text-xs font-bold text-gray-500 mb-2 ml-1 uppercase tracking-wider"
                >Confirm Password</label
              >
              <div class="relative">
                <input
                  type="password"
                  id="signup-confirm"
                  placeholder="Confirm the Password"
                  class="w-full bg-bg border border-border rounded-xl px-4 py-3 pr-10 focus:border-accent-blue outline-none transition-colors text-white placeholder-muted"
                />
                <button
                  type="button"
                  class="absolute right-3 top-1/2 -translate-y-1/2 text-secondary hover:text-white transition-colors"
                  onclick="Controller.togglePassword('signup-confirm', this)"
                >
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>
            <button
              onclick="Controller.handleSignup()"
              class="w-full bg-white text-black font-bold py-3 rounded-xl active:scale-95 transition-all shadow-lg mt-2"
            >
              Verify & Sign Up
            </button>
          </div>
        </div>
      </div>
    </div>
    <div
      id="verify-modal"
      class="fixed inset-0 bg-black/90 hidden z-[20000] flex items-center justify-center p-6 backdrop-blur-xl"
    >
      <div
        class="bg-panel border border-border rounded-2xl p-8 w-full max-w-md shadow-2xl text-center"
      >
        <i class="fas fa-envelope-open-text text-4xl text-accent-blue mb-4"></i>
        <h3 class="text-xl font-bold mb-2">Verify Your Email</h3>
        <p class="text-secondary mb-6 text-sm">
          We've sent a verification email to your inbox. <br />
          <strong
            >Please click the link in the email to verify your account.</strong
          ><br />
          If you don't see it, check your spam folder.
        </p>
        <button
          id="btn-verify-check"
          class="w-full bg-white text-black font-bold py-3 rounded-xl active:scale-95 transition-all shadow-lg"
        >
          I have verified my Email
        </button>
        <button
          onclick="location.reload()"
          class="mt-4 text-xs text-secondary hover:text-white"
        >
          Cancel / Logout
        </button>
      </div>
    </div>
    <div
      id="waiting-screen"
      class="fixed inset-0 z-[15000] bg-black/90 hidden flex-col items-center justify-center p-6 text-center backdrop-blur-xl"
    >
      <i class="fas fa-clock text-4xl mb-4 text-accent-blue animate-pulse"></i>
      <h2 class="text-2xl font-bold mb-2">Waiting for Host</h2>
      <p class="text-secondary">
        Please wait while the host accepts your request to join.
      </p>
    </div>
    <div
      id="modal"
      class="fixed inset-0 bg-black/80 hidden z-[10000] flex items-center justify-center p-6 backdrop-blur-md"
    >
      <div
        class="bg-panel border border-border rounded-2xl p-6 w-full max-w-sm shadow-2xl transform transition-all scale-100"
      >
        <h3 id="modal-title" class="text-xl font-bold mb-2 text-center">
          Confirm
        </h3>
        <p id="modal-text" class="text-secondary mb-6 text-center text-sm">
          Are You Sure?
        </p>
        <div class="flex gap-3">
          <button
            id="modal-cancel"
            class="flex-1 py-3 border border-border rounded-xl text-secondary font-medium hover:bg-element active:scale-95 transition-transform"
          >
            Cancel
          </button>
          <button
            id="modal-confirm"
            class="flex-1 py-3 bg-white text-black rounded-xl font-bold hover:bg-btnHover active:scale-95 transition-transform"
          >
            Confirm
          </button>
        </div>
      </div>
    </div>
    <div
      id="lobby"
      class="fixed inset-0 z-50 bg-bg hidden flex-col items-center justify-center p-6 pt-safe pb-safe"
    >
      <div class="w-full max-w-sm flex flex-col h-full justify-center">
        <h1
          class="text-4xl font-bold text-center mb-8 tracking-tighter text-transparent bg-clip-text bg-gradient-to-br from-white to-gray-400 drop-shadow-2xl"
        >
          Watch Party
        </h1>
        <div
          class="bg-panel rounded-2xl border border-border overflow-hidden shadow-2xl"
        >
          <div class="flex h-14 border-b border-border">
            <button
              class="flex-1 font-bold text-secondary hover:text-white transition-colors bg-panel data-[active=true]:bg-element data-[active=true]:text-white text-xs uppercase tracking-wide"
              data-tab="join"
              data-active="true"
              onclick="Controller.switchTab('join')"
            >
              Join Room
            </button>
            <button
              class="flex-1 font-bold text-secondary hover:text-white transition-colors bg-panel data-[active=true]:bg-element data-[active=true]:text-white text-xs uppercase tracking-wide"
              data-tab="host"
              onclick="Controller.switchTab('host')"
            >
              Host Room
            </button>
          </div>
          <div class="p-6 space-y-4">
            <div>
              <label
                id="label-room"
                for="input-room"
                class="block text-xs font-bold text-gray-500 mb-2 ml-1 uppercase tracking-wider"
                >Room Code</label
              >
              <input
                type="text"
                id="input-room"
                placeholder="Enter the Room Code"
                class="w-full bg-bg border border-border rounded-xl px-4 py-3 focus:border-accent-blue outline-none transition-colors text-white placeholder-muted"
              />
            </div>
            <button
              id="btn-enter"
              class="w-full bg-white text-black font-bold py-3 rounded-xl active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg mt-2"
            >
              <i id="spinner" class="fas fa-circle-notch fa-spin hidden"></i>
              <span id="btn-enter-text">Enter Room</span>
            </button>
          </div>
        </div>
        <div class="text-center mt-4">
          <button
            onclick="Controller.logout()"
            class="text-secondary text-xs hover:text-white"
          >
            Log out
          </button>
        </div>
      </div>
    </div>

    <div
      id="room"
      class="hidden flex-col h-full w-full bg-black overflow-hidden fixed inset-0"
    >
      <header
        class="bg-panel/95 backdrop-blur-xl border-b border-border w-full shrink-0 z-[120] relative shadow-lg transition-all duration-300"
      >
        <div class="pt-safe w-full">
          <div class="h-14 px-4 flex justify-between items-center gap-2">
            <div class="flex items-center gap-3 min-w-0 flex-1">
              <div
                class="bg-element/50 rounded-full px-3 py-1.5 flex items-center gap-2 border border-border/50 min-w-0 max-w-full"
              >
                <span
                  id="header-room-name"
                  class="text-sm font-semibold text-white truncate"
                  >Watch Party</span
                >
                <span class="w-px h-3 bg-white/20 shrink-0"></span>
                <span
                  id="header-room-id"
                  class="text-secondary text-xs font-mono tracking-wide shrink-0"
                  >#------</span
                >
              </div>
              <button
                id="btn-copy"
                class="bg-element/50 border border-border/50 text-white cursor-pointer rounded-full flex items-center justify-center active:bg-white/10 transition-colors w-9 h-9 shrink-0 hover:bg-element"
                title="Copy Room ID"
              >
                <i class="fas fa-copy text-xs"></i>
              </button>
            </div>
            <div class="flex items-center gap-3 shrink-0">
              <button
                id="btn-header-sidebar-toggle"
                class="bg-element/50 border border-border/50 text-white p-2 w-9 h-9 flex items-center justify-center active:scale-90 transition-transform rounded-full hover:bg-element cursor-pointer"
                onclick="Controller.toggleSidebar()"
              >
                <i id="icon-menu" class="fas fa-bars text-sm"></i>
              </button>
              <button
                id="btn-leave"
                class="bg-danger-bg border border-danger-text/60 text-danger-text w-9 h-9 rounded-full cursor-pointer text-xs flex items-center justify-center hover:bg-danger-text/10 active:scale-90 transition-all shadow-lg"
              >
                <i class="fas fa-sign-out-alt"></i>
              </button>
            </div>
          </div>
        </div>
      </header>
      <div class="flex-1 flex overflow-hidden relative">
        <main
          class="flex-1 flex flex-col relative bg-black group touch-none select-none min-w-0"
        >
          <div
            id="video-wrapper"
            class="flex-1 flex items-center justify-center bg-black relative w-full h-full overflow-hidden"
          >
            <video
              id="video"
              class="w-full h-full object-contain"
              playsinline
              webkit-playsinline
            ></video>
            <div
              id="placeholder"
              class="absolute inset-0 z-40 flex flex-col items-center justify-center text-center bg-black p-6"
            >
              <div
                class="flex flex-col items-center justify-center w-full max-w-sm"
              >
                <div class="w-16 h-16 mx-auto mb-6 opacity-40">
                  <svg
                    class="w-full h-full stroke-secondary fill-none stroke-1"
                    viewBox="0 0 24 24"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                  </svg>
                </div>
                <h2 class="text-white text-xl font-bold mb-3 tracking-tight">
                  No Video Loaded
                </h2>
                <div class="text-secondary text-sm mb-8 text-center px-4">
                  Tap Below To Select a Video File From Your Device.
                </div>
                <button
                  id="btn-upload"
                  class="bg-white text-black border-none px-8 py-3 rounded-full text-sm font-bold cursor-pointer hover:bg-gray-200 active:scale-95 transition-all shadow-xl"
                >
                  Select Movie File
                </button>
              </div>
            </div>
            <input
              type="file"
              id="file-video"
              accept="video/*,.mkv,.mp4,.webm"
              class="hidden"
            />
            <input
              type="file"
              id="file-sub"
              accept=".vtt,.srt"
              class="hidden"
            />
            <div
              class="absolute inset-y-0 left-0 w-1/4 z-10 touch-none"
              id="zone-left"
            ></div>
            <div
              class="absolute inset-y-0 right-0 w-1/4 z-10 touch-none"
              id="zone-right"
            ></div>
            <div
              class="absolute inset-y-0 left-1/4 w-1/2 z-10 flex items-center justify-center cursor-pointer touch-none"
              id="zone-center"
            ></div>
            <div
              id="gesture-feedback"
              class="absolute top-8 left-1/2 -translate-x-1/2 bg-black/60 backdrop-blur-md border border-white/10 px-5 py-2 rounded-full font-bold text-sm opacity-0 transition-opacity pointer-events-none z-30 shadow-2xl flex items-center gap-2"
            >
              <span class="text-accent-blue">‚óè</span>
              <span id="gesture-text">Vol: 100%</span>
            </div>
            <div
              id="anim-layer"
              class="absolute inset-0 pointer-events-none z-20 flex items-center justify-center"
            >
              <div
                class="relative w-full h-full flex items-center justify-center"
              >
                <i
                  id="icon-seek-back"
                  class="fas fa-rotate-left text-5xl opacity-0 absolute left-[20%] text-white drop-shadow-md"
                ></i>
                <i
                  id="icon-play-pause"
                  class="fas fa-play text-7xl opacity-0 text-white drop-shadow-lg scale-150"
                ></i>
                <i
                  id="icon-seek-fwd"
                  class="fas fa-rotate-right text-5xl opacity-0 absolute right-[20%] text-white drop-shadow-md"
                ></i>
              </div>
            </div>
            <div
              id="video-typing-indicator"
              class="absolute top-20 right-4 px-4 py-2 text-xs text-white/80 bg-black/50 backdrop-blur-md rounded-full border border-white/10 hidden flex items-center gap-2 z-[60]"
            >
              <span>Someone is typing...</span>
              <div class="flex items-center gap-1">
                <div class="typing-dot bg-white"></div>
                <div class="typing-dot bg-white"></div>
                <div class="typing-dot bg-white"></div>
              </div>
            </div>
            <div
              id="chat-overlay"
              class="absolute bottom-24 right-4 flex flex-col items-end pointer-events-none z-30 w-72 space-y-2 pb-safe pr-safe h-64 justify-end overflow-hidden"
            ></div>
            <button
              id="btn-unlock"
              class="absolute top-6 right-6 z-[60] bg-black/60 border border-white/20 w-12 h-12 rounded-full flex items-center justify-center backdrop-blur shadow-2xl active:scale-90 transition-transform ui-instant-hide"
            >
              <i id="icon-lock" class="fas fa-lock-open text-white text-lg"></i>
            </button>
            <div
              id="controls"
              class="absolute bottom-0 left-0 right-0 bg-panel/95 backdrop-blur-xl border-t border-border px-4 pb-safe pt-4 shrink-0 transition-all duration-300 z-50 shadow-[0_-10px_40px_rgba(0,0,0,0.5)] ui-instant-hide translate-y-full"
            >
              <div class="flex items-center gap-3 w-full mb-3">
                <span
                  id="time-cur"
                  class="text-white/90 text-xs font-mono w-[45px] text-right select-none drop-shadow"
                  >0:00</span
                >
                <div
                  id="progress-container"
                  class="flex-1 h-8 relative cursor-pointer group/prog flex items-center touch-none"
                >
                  <div
                    class="w-full h-1 bg-white/10 rounded-full relative overflow-hidden pointer-events-none"
                  >
                    <div
                      id="progress-fill"
                      class="h-full bg-accent-light w-0 absolute top-0 left-0 shadow-[0_0_10px_rgba(96,165,250,0.5)]"
                    ></div>
                  </div>
                  <div
                    id="progress-handle"
                    class="absolute w-4 h-4 bg-white rounded-full left-0 -ml-[8px] shadow-lg pointer-events-none scale-100 transition-transform border border-black/10"
                  ></div>
                </div>
                <span
                  id="time-dur"
                  class="text-white/90 text-xs font-mono w-[45px] text-left select-none cursor-pointer hover:text-white drop-shadow"
                  title="Toggle Remaining Time"
                  >0:00</span
                >
              </div>
              <div class="flex justify-between items-center relative py-1">
                <div class="flex items-center gap-3 justify-start">
                  <button
                    class="bg-transparent border-none text-white/80 cursor-pointer p-2 rounded-full flex items-center justify-center hover:text-white active:bg-white/10 transition-all w-12 h-12"
                    data-action="play"
                  >
                    <i class="fas fa-play text-xl"></i>
                  </button>
                  <button
                    class="bg-transparent border-none text-white/80 cursor-pointer p-2 rounded-full flex items-center justify-center hover:text-white active:bg-white/10 transition-all w-10 h-10"
                    data-action="seek-back"
                  >
                    <i class="fas fa-rotate-left text-lg"></i>
                  </button>
                  <button
                    class="bg-transparent border-none text-white/80 cursor-pointer p-2 rounded-full flex items-center justify-center hover:text-white active:bg-white/10 transition-all w-10 h-10"
                    data-action="seek-fwd"
                  >
                    <i class="fas fa-rotate-right text-lg"></i>
                  </button>
                </div>
                <div class="flex gap-2 items-center">
                  <div class="relative">
                    <button
                      class="bg-transparent border-none text-white/80 cursor-pointer p-2 rounded-full flex items-center justify-center hover:text-white active:bg-white/10 transition-all w-10 h-10"
                      data-action="toggle-more"
                    >
                      <i class="fas fa-ellipsis-h text-lg"></i>
                    </button>
                    <div id="menu-more" class="control-menu">
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-sm text-white transition-colors flex items-center gap-3"
                        data-action="open-menu-aspect"
                      >
                        <i class="fas fa-tv w-5 text-center"></i> Aspect Ratio
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-sm text-white transition-colors flex items-center gap-3"
                        data-action="open-menu-speed"
                      >
                        <i class="fas fa-tachometer-alt w-5 text-center"></i>
                        Playback Speed
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-sm text-white transition-colors flex items-center gap-3"
                        data-action="open-menu-orient"
                      >
                        <i class="fas fa-mobile-screen w-5 text-center"></i>
                        Screen Orientation
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-sm text-white transition-colors flex items-center gap-3"
                        data-action="open-menu-sub"
                      >
                        <i class="fas fa-closed-captioning w-5 text-center"></i>
                        Subtitles
                      </button>
                    </div>
                    <div id="menu-speed" class="control-menu">
                      <button
                        class="text-left px-4 py-2 hover:bg-element rounded-xl text-xs text-secondary transition-colors mb-2 flex items-center gap-2"
                        data-action="back-to-more"
                      >
                        <i class="fas fa-chevron-left"></i> Back
                      </button>
                      <div
                        class="px-3 py-2 text-[10px] text-gray-400 font-bold uppercase tracking-wider text-center"
                      >
                        Speed: <span id="disp-speed">1x</span>
                      </div>
                      <div
                        class="px-2 py-2"
                        onmousedown="event.stopPropagation()"
                        ontouchstart="event.stopPropagation()"
                      >
                        <input
                          type="range"
                          min="0.5"
                          max="2"
                          step="0.25"
                          value="1"
                          class="w-full cursor-pointer h-10 touch-none"
                          oninput="Controller.setSpeed(this.value)"
                        />
                      </div>
                    </div>
                    <div id="menu-aspect" class="control-menu">
                      <button
                        class="text-left px-4 py-2 hover:bg-element rounded-xl text-xs text-secondary transition-colors mb-2 flex items-center gap-2"
                        data-action="back-to-more"
                      >
                        <i class="fas fa-chevron-left"></i> Back
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-xs text-white transition-colors flex justify-between"
                        onclick="Controller.setAspect('Original')"
                      >
                        Original
                        <span class="active-check hidden" data-val="Original">
                          <i class="fas fa-check"></i>
                        </span>
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-xs text-white transition-colors flex justify-between"
                        onclick="Controller.setAspect('Fill')"
                      >
                        Panscan (Fill)
                        <span class="active-check hidden" data-val="Fill">
                          <i class="fas fa-check"></i>
                        </span>
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-xs text-white transition-colors flex justify-between"
                        onclick="Controller.setAspect('16:9')"
                      >
                        16:9
                        <span class="active-check hidden" data-val="16:9">
                          <i class="fas fa-check"></i>
                        </span>
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-xs text-white transition-colors flex justify-between"
                        onclick="Controller.setAspect('16:10')"
                      >
                        16:10
                        <span class="active-check hidden" data-val="16:10">
                          <i class="fas fa-check"></i>
                        </span>
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-xs text-white transition-colors flex justify-between"
                        onclick="Controller.setAspect('4:3')"
                      >
                        4:3
                        <span class="active-check hidden" data-val="4:3">
                          <i class="fas fa-check"></i>
                        </span>
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-xs text-white transition-colors flex justify-between"
                        onclick="Controller.setAspect('2.35:1')"
                      >
                        2.35:1
                        <span class="active-check hidden" data-val="2.35:1">
                          <i class="fas fa-check"></i>
                        </span>
                      </button>
                    </div>
                    <div id="menu-orient" class="control-menu">
                      <button
                        class="text-left px-4 py-2 hover:bg-element rounded-xl text-xs text-secondary transition-colors mb-2 flex items-center gap-2"
                        data-action="back-to-more"
                      >
                        <i class="fas fa-chevron-left"></i> Back
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-xs text-white transition-colors flex justify-between"
                        onclick="Controller.setOrient('auto')"
                      >
                        Auto
                        <span class="active-check hidden" data-val="auto">
                          <i class="fas fa-check"></i>
                        </span>
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-xs text-white transition-colors flex justify-between"
                        onclick="Controller.setOrient('landscape')"
                      >
                        Landscape
                        <span class="active-check hidden" data-val="landscape">
                          <i class="fas fa-check"></i>
                        </span>
                      </button>
                      <button
                        class="menu-item text-left px-4 py-3 hover:bg-element rounded-xl text-xs text-white transition-colors flex justify-between"
                        onclick="Controller.setOrient('portrait')"
                      >
                        Portrait
                        <span class="active-check hidden" data-val="portrait">
                          <i class="fas fa-check"></i>
                        </span>
                      </button>
                    </div>
                    <div id="menu-sub" class="control-menu">
                      <button
                        class="text-left px-4 py-2 hover:bg-element rounded-xl text-xs text-secondary transition-colors mb-2 flex items-center gap-2"
                        data-action="back-to-more"
                      >
                        <i class="fas fa-chevron-left"></i> Back
                      </button>
                      <div
                        class="px-3 py-2 text-[10px] text-gray-400 font-bold uppercase tracking-wider text-center"
                      >
                        Font Size: <span id="disp-sub-size">100%</span>
                      </div>
                      <div
                        class="px-2 py-2 mb-2"
                        onmousedown="event.stopPropagation()"
                        ontouchstart="event.stopPropagation()"
                      >
                        <input
                          type="range"
                          min="50"
                          max="200"
                          step="10"
                          value="100"
                          class="w-full cursor-pointer h-10 touch-none"
                          oninput="Controller.setSubtitleSize(this.value)"
                        />
                      </div>
                      <div
                        id="btn-load-sub"
                        class="px-4 py-3 hover:bg-element active:bg-element/80 rounded-xl text-xs text-left cursor-pointer text-white font-medium transition-colors"
                      >
                        Load Subtitle File
                      </div>
                      <div class="h-px bg-border my-1 mx-2"></div>
                      <div
                        id="track-list"
                        class="max-h-40 overflow-y-auto text-white scrollbar-thin px-2 pb-2"
                      ></div>
                    </div>
                  </div>
                  <button
                    class="bg-transparent border-none text-white/80 cursor-pointer p-2 rounded-full flex items-center justify-center hover:text-white active:bg-white/10 transition-all w-10 h-10"
                    data-action="toggle-quick-chat"
                  >
                    <i class="fas fa-comments text-lg"></i>
                  </button>
                  <button
                    class="bg-transparent border-none text-white/80 cursor-pointer p-2 rounded-full flex items-center justify-center hover:text-white active:bg-white/10 transition-all w-10 h-10"
                    data-action="fullscreen"
                  >
                    <i class="fas fa-expand text-lg"></i>
                  </button>
                </div>
              </div>
            </div>
            <div
              id="quick-chat"
              class="absolute bottom-48 left-4 right-4 bg-panel/95 backdrop-blur-xl border border-border rounded-3xl flex flex-col p-3 gap-2 transform translate-y-20 ui-hidden ui-instant-hide z-[70] shadow-2xl pl-3 pr-3 transition-all duration-300"
            >
              <div
                id="quick-chat-autocomplete"
                class="hidden absolute bottom-full left-0 right-0 bg-panel border border-border rounded-xl mb-2 shadow-2xl overflow-hidden z-50"
              ></div>
              <div class="flex items-end gap-2 w-full">
                <div
                  id="quick-chat-input"
                  contenteditable="true"
                  class="chat-input-box flex-1 bg-element border border-[#333] text-primary px-4 py-3 rounded-2xl text-sm outline-none focus:border-accent-blue placeholder:text-muted transition-colors whitespace-pre-wrap break-words"
                  placeholder="Type a Message..."
                  onkeydown="Controller.handleInputKeydown(event, 'quick')"
                  oninput="Controller.handleInput(this, 'quick')"
                ></div>
                <button
                  id="quick-chat-send"
                  class="bg-accent-blue border-none text-white w-14 h-14 rounded-full cursor-pointer flex items-center justify-center shrink-0 hover:bg-blue-600 active:scale-95 transition-all shadow-lg ml-1"
                  onclick="Controller.submitChat('quick')"
                >
                  <i class="fas fa-paper-plane text-lg"></i>
                </button>
              </div>
            </div>
          </div>
        </main>
        <aside
          id="sidebar"
          class="absolute inset-0 md:static md:inset-auto md:h-full md:w-[350px] z-[110] bg-panel md:border-l md:border-border flex flex-col transform transition-transform duration-300 translate-x-full md:translate-x-0 pt-safe pb-safe shadow-2xl"
        >
          <div
            class="p-4 border-b border-border shrink-0 flex items-center justify-between h-14"
          >
            <div
              class="flex items-center gap-2 text-secondary text-sm font-bold"
            >
              <i class="fas fa-users text-sm"></i> Members
              <span
                id="member-count"
                class="bg-element border border-border text-xs font-bold text-white px-2 py-0.5 rounded ml-1"
                >0</span
              >
            </div>
          </div>
          <div class="p-2 border-b border-border bg-panel shrink-0">
            <div
              id="member-list"
              class="space-y-1 max-h-32 overflow-y-auto scrollbar-thin"
            ></div>
          </div>
          <div class="flex-1 flex flex-col min-h-0 relative">
            <div
              class="p-3 border-b border-border bg-panel shrink-0 text-secondary text-sm font-bold flex items-center gap-2"
            >
              <i class="fas fa-comments text-sm"></i> Chat
            </div>
            <div
              id="chat-list"
              class="flex-1 overflow-y-auto scrollbar-thin p-4 space-y-3 pb-20 flex flex-col"
            ></div>
            <div
              id="typing-indicator"
              class="px-4 py-2 text-xs text-gray-400 hidden flex items-center gap-2"
            >
              <span>Someone is typing</span>
              <div class="flex items-center bg-element px-2 py-1.5 rounded-xl">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
              </div>
            </div>
            <div
              class="absolute bottom-0 left-0 right-0 p-3 bg-panel border-t border-border"
              id="chat-input-container"
            >
              <div
                id="sidebar-autocomplete"
                class="hidden absolute bottom-full left-3 right-3 bg-panel border border-border rounded-xl mb-2 shadow-2xl overflow-hidden z-50"
              ></div>
              <div class="flex items-end gap-2 w-full">
                <div
                  id="chat-input"
                  contenteditable="true"
                  class="chat-input-box flex-1 bg-element border border-[#333] text-primary px-4 py-3 rounded-2xl text-sm outline-none focus:border-accent-blue placeholder:text-muted transition-colors whitespace-pre-wrap break-words"
                  placeholder="Type a Message..."
                  onkeydown="Controller.handleInputKeydown(event, 'sidebar')"
                  oninput="Controller.handleInput(this, 'sidebar')"
                ></div>
                <button
                  id="chat-send"
                  class="bg-accent-blue border-none text-white w-14 h-14 rounded-full cursor-pointer flex items-center justify-center shrink-0 hover:bg-blue-600 active:scale-95 transition-all shadow-lg"
                  onclick="Controller.submitChat('sidebar')"
                >
                  <i class="fas fa-paper-plane text-lg"></i>
                </button>
              </div>
            </div>
          </div>
        </aside>
      </div>
    </div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
